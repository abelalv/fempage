<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>simulation_fem - Introduction to FEM</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">simulation_fem</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./edp.html">Classification of partrial differential equations</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./introFEM.html" aria-current="page">Introduction to FEM</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./2dbasis.html">2d Basis funtions as tensor products of 1D functions</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./aproxfem.html">Function approximation by finite elements</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-to-fem" id="toc-introduction-to-fem" class="nav-link active" data-scroll-target="#introduction-to-fem">Introduction to FEM</a>
  <ul class="collapse">
  <li><a href="#proyection-to-simple-functions-and-square-minimization" id="toc-proyection-to-simple-functions-and-square-minimization" class="nav-link" data-scroll-target="#proyection-to-simple-functions-and-square-minimization">Proyection to simple functions and square minimization</a></li>
  <li><a href="#numerical-aproximation-of-intergrals" id="toc-numerical-aproximation-of-intergrals" class="nav-link" data-scroll-target="#numerical-aproximation-of-intergrals">Numerical aproximation of intergrals</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction to FEM</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="introduction-to-fem" class="level1">
<h1>Introduction to FEM</h1>
<p>FEM is a numerical method to aaproximate solved the differential equation by a finite number of points. The method is based on the idea that the solution of the differential equation can be approximated by a function that is a linear combination of a finite number of basis functions. The basis functions are chosen to be continuous and differentiable, and the coefficients of the linear combination are determined by the boundary conditions. The basis functions are usually chosen to be polynomials, but other functions can be used as well. The method is called finite element method because the basis functions are usually chosen to be piecewise polynomials, which are called finite elements. The method is also called finite element analysis because the method is used to analyze the behavior of structures.</p>
<p>Let vectorial space <span class="math inline">\(V\)</span> be a Hilbert space, and let <span class="math inline">\(\{\phi_i\}\)</span> be a set indepent linear of functions in <span class="math inline">\(V\)</span>. The function <span class="math inline">\(u\)</span> is the solution of EDP, this can be approximate in linear combination of elements set <span class="math inline">\(\{\phi_i\}\)</span>, that is, <span class="math inline">\(u(x,y)=\sum_{i=1}^n c_i\phi_i(x,y)\)</span>, where <span class="math inline">\(c_i\)</span> are the coefficients of the linear combination. The coefficients <span class="math inline">\(c_i\)</span> are determined by the boundary conditions. The method is called finite element method because the basis functions are usually chosen to be piecewise polynomials, which are called finite elements. The method is also called finite element analysis because the method is used to analyze the behavior of structures.</p>
<section id="proyection-to-simple-functions-and-square-minimization" class="level3">
<h3 class="anchored" data-anchor-id="proyection-to-simple-functions-and-square-minimization">Proyection to simple functions and square minimization</h3>
<p>Let a vector <span class="math inline">\(u\)</span>, we can proyection this vector in a subspace <span class="math inline">\(V\)</span>, which has the element <span class="math inline">\(\{ \phi_0\}\)</span>, thus</p>
<p><span class="math display">\[u=c_0\phi_0\in V,\]</span> we can definete the error <span class="math inline">\(e\)</span> as <span class="math inline">\(e=u-c_0\phi_0.\)</span> thus the norm is <span class="math display">\[\|e\|^2=\|u-c_0\phi_0\|^2=\|u\|^2-2c_0\langle u,\phi_0\rangle+c_0^2\| \phi_0\|^2.\]</span></p>
<p>We can minimize the error <span class="math inline">\(e\)</span> by choosing the coefficient <span class="math inline">\(c_0\)</span> that minimize the error, thus we have <span class="math display">\[\frac{\partial}{\partial c_0}\|e\|^2=0,\]</span> and we have <span class="math display">\[\frac{\partial}{\partial c_0}\|e\|^2=-2\langle u,\phi_0\rangle+2c_0\| \phi_0\|^2=0.\]</span></p>
<p>Thus we have <span class="math display">\[c_0=\frac{\langle u,\phi_0\rangle}{\| \phi_0\|^2}.\]</span></p>
<p>Note that qe can be a proyection of <span class="math inline">\(u\)</span> in <span class="math inline">\(V\)</span> if we use the fact that <span class="math inline">\(e\)</span> is orthogonal to <span class="math inline">\(V\)</span>, thus we have <span class="math display">\[\langle e,s\phi_0\rangle=s\langle e,s\phi_0\rangle=0.\]</span> then <span class="math inline">\(s=0\)</span> or <span class="math inline">\(\langle e,\phi_0\rangle=0.\)</span></p>
<p>Note that in the proyection <span class="math inline">\(c_0=\frac{\langle u,\phi_0\rangle}{\| \phi_0\|^2}\)</span>, is similar to the minimization of the square error.</p>
<p>We can generalize this result to a set of functions <span class="math inline">\(\{\phi_i\}\)</span>, thus we have</p>
<p><span class="math display">\[u=\sum_{i=1}^n c_i\phi_i\in V,\]</span> we can definete the error <span class="math inline">\(e\)</span> as <span class="math inline">\(e=u-\sum_{i=1}^n c_i\phi_i.\)</span> thus the norm is <span class="math display">\[E=\|e\|^2=\|u-\sum_{i=1}^n c_i\phi_i\|^2=\|u\|^2-2\sum_{i=1}^n c_i\langle u,\phi_i\rangle+\sum_{q=0}^n\sum_{p=0}^n c_pc_q \langle\phi_p,\phi_q\rangle.\]</span></p>
<p>We can minimize the error <span class="math inline">\(e\)</span> by choosing the coefficient <span class="math inline">\(c_i\)</span> that minimize the error, thus we have</p>
<p><span class="math display">\[\frac{\partial}{\partial c_i}E=0,\ \ i=0,...N.\]</span> Note that <span class="math display">\[\frac{\partial}{\partial c_i}c_pc_q=\begin{cases}c_q &amp; i=p \text{ and } q\neq i\\c_p &amp; i\neq p \text{ and } q=i\\ 2c_i  &amp; i=p \text{ and } q= i\\ 0 &amp; \text{otherwise}\end{cases}\]</span></p>
<p>Thus we have <span class="math display">\[\frac{\partial}{\partial c_i}E=\sum_{p=0,p\neq i}^n c_p\langle \phi_p,\phi_q\rangle+\sum_{q=0,q\neq i}^nc_q \langle\phi_i,\phi_q\rangle+2c_i \langle\phi_i,\phi_i\rangle\]</span></p>
<p>Thus <span class="math display">\[\frac{\partial}{\partial c_i}E=0,\ i=0,...N.\]</span> implies <span class="math display">\[-2f\langle u,\phi_i\rangle+2\sum_{j=0}^N\langle \phi_j,\phi_i\rangle=0.\ \ i=0,...N.\]</span></p>
<p>we can write this as linear system</p>
<p><span class="math display">\[\sum_{j=0}^N\langle \phi_j,\phi_i\rangle=c_i\langle \phi_i,\phi_i\rangle,\ \ i=0,...N.\]</span></p>
<p><span class="math display">\[\sum_{j=0}^NA_{i,j}c_j=b_i,\ \ i=0,...N.\]</span> where <span class="math inline">\(A_{i,j}=\langle \phi_j,\phi_i\rangle\)</span> and <span class="math inline">\(b_i=f\langle u,\phi_i\rangle\)</span>.</p>
<p>Note that the matrix <span class="math inline">\(A\)</span> is symmetric.</p>
<p>The similar form of the linear system is the form of the Galerkin method.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sym</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> least_squares(f, psi, Omega):</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="bu">len</span>(psi) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> sym.zeros(N<span class="op">+</span><span class="dv">1</span>, N<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> sym.zeros(N<span class="op">+</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> sym.Symbol(<span class="st">'x'</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, N<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>            A[i,j] <span class="op">=</span> sym.integrate(psi[i]<span class="op">*</span>psi[j],(x, Omega[<span class="dv">0</span>], Omega[<span class="dv">1</span>]))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>            A[j,i] <span class="op">=</span> A[i,j]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        b[i,<span class="dv">0</span>] <span class="op">=</span> sym.integrate(psi[i]<span class="op">*</span>f, (x, Omega[<span class="dv">0</span>], Omega[<span class="dv">1</span>]))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> A.LUsolve(b)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note: c is a sympy Matrix object, solution is in c[:,0]</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    u <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(psi)):</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        u <span class="op">+=</span> c[i,<span class="dv">0</span>]<span class="op">*</span>psi[i]</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> u, c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="cell-output cell-output-stdout">
<pre><code>10*x - 38/3
10*x**2 - 20*x + 9</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="introFEM_files/figure-html/cell-3-output-2.png" width="569" height="411"></p>
</div>
</div>
</section>
<section id="numerical-aproximation-of-intergrals" class="level2">
<h2 class="anchored" data-anchor-id="numerical-aproximation-of-intergrals">Numerical aproximation of intergrals</h2>
<p>Some time we need to aproximate the integral of a function, because the calculus is not possible, the function is not analytic or demanis a lot of time to calculate the integral. In FEM we need to aproximate the integral fast, thus we use the numerical integration. We can use the following methods to inegrate</p>
<pre><code>-   scipy.integrate.quad (precision set to $10^{-8}$),

-   mpmath.quad (about machine precision),

-   Trapezoidal rule based on the points in x (unknown accuracy, but increasing with the number of mesh points in x).</code></pre>
<p>There many methods to approximate the integral, but we concentrate in the previus methods.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>